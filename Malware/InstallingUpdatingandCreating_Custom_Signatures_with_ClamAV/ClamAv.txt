1. Cài đặt ClamAV trên Ubuntu
Bước 1: Cập nhật kho phần mềm

Bạn cần cập nhật hệ thống để đảm bảo các gói phần mềm được lấy từ phiên bản mới nhất:
bash
Copy code
sudo apt update
sudo reboot
Sau khi cập nhật xong, bạn nên khởi động lại hệ thống.
Bước 2: Cài đặt ClamAV và daemon của nó

Sử dụng apt để cài đặt ClamAV và dịch vụ nền clamav-daemon:
bash
Copy code
sudo apt install clamav clamav-daemon
Bước 3: Kiểm tra phiên bản

Sau khi cài đặt xong, bạn kiểm tra phiên bản ClamAV đã cài:
bash
Copy code
clamscan --version
2. Cập nhật cơ sở dữ liệu chữ ký (signature database)
ClamAV sử dụng cơ sở dữ liệu chữ ký để nhận diện malware. Việc cập nhật thường xuyên là rất quan trọng.

Dừng dịch vụ freshclam (dịch vụ tự động cập nhật)

Trước khi cập nhật thủ công, bạn cần dừng dịch vụ tự động cập nhật freshclam:
bash
Copy code
sudo systemctl stop clamav-freshclam
Phương pháp 1: Cập nhật cơ sở dữ liệu bằng freshclam

Sử dụng lệnh này để cập nhật:
bash
Copy code
sudo freshclam
Phương pháp 2: Cập nhật từ trang web chính thức

Bạn cũng có thể tải tệp cơ sở dữ liệu từ trang web chính thức: https://database.clamav.net/daily.cvd
Sao chép tệp này vào thư mục ClamAV:
bash
Copy code
sudo cp daily.cvd /var/lib/clamav/
3. Quét hệ thống với ClamAV
Bạn có thể quét một thư mục cụ thể bằng lệnh clamscan. Ví dụ, quét thư mục "Documents":

bash
Copy code
sudo clamscan --infected --remove --recursive ~/Documents
--infected: Hiển thị các tệp bị nhiễm.
--remove: Xóa tệp bị nhiễm.
--recursive: Quét cả các thư mục con.
4. Tạo chữ ký tùy chỉnh để phát hiện malware
ClamAV cho phép bạn tạo các chữ ký tùy chỉnh để quét file theo nội dung bạn định nghĩa.

Bước 1: Tạo chữ ký tùy chỉnh

Bạn tạo một tệp mới có tên Clam_HelloWorld.ndb chứa nội dung sau:
bash
Copy code
sudo nano Clam_HelloWorld.ndb
Thêm dòng sau vào:
makefile
Copy code
Clam_HelloWorld:0:*:68656c6c6f*776f726c64
Dòng này nói rằng, nếu ClamAV tìm thấy bất kỳ file nào chứa chuỗi hex 68656c6c6f (là "hello") và 776f726c64 (là "world"), thì nó sẽ coi file đó bị nhiễm malware.
Bước 2: Tạo file để thử nghiệm

Bạn tạo một tệp test với nội dung "hello world":
bash
Copy code
sudo nano test.txt
Thêm dòng "hello world" vào tệp và lưu lại.
Bước 3: Quét file

Dùng lệnh sau để quét tệp test.txt với chữ ký tùy chỉnh:
bash
Copy code
clamscan -d Clam_HelloWorld.ndb test.txt
ClamAV sẽ nhận diện tệp test.txt bị nhiễm vì chứa chuỗi "hello world" theo chữ ký mà bạn đã định nghĩa.
Ví dụ tương tự:
Giả sử bạn muốn tạo một chữ ký phát hiện các file chứa chuỗi "dangerous code".

Bước 1: Tạo chữ ký mới

Tạo tệp Clam_DangerCode.ndb với nội dung sau:
bash
Copy code
sudo nano Clam_DangerCode.ndb
Thêm dòng:
makefile
Copy code
Clam_DangerCode:0:*:64616e6765726f7573*636f6465
Chuỗi hex 64616e6765726f7573 là "dangerous" và 636f6465 là "code".
Bước 2: Tạo file thử nghiệm

Tạo tệp chứa chuỗi "dangerous code":
bash
Copy code
sudo nano test_danger.txt
Viết "dangerous code" vào file.
Bước 3: Quét tệp

Dùng lệnh để quét file mới:
bash
Copy code
clamscan -d Clam_DangerCode.ndb test_danger.txt
Kết quả sẽ báo rằng file bị nhiễm theo chữ ký tùy chỉnh của bạn.
Những ví dụ này giúp bạn hiểu cách ClamAV hoạt động và cách tạo chữ ký để phát hiện nội dung nhất định trong các file.